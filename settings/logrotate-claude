# Logrotate configuration for Claude Code sandbox logs
# Place in /etc/logrotate.d/claude

/var/log/claude-audit/command-audit.jsonl {
    daily
    rotate 7
    missingok
    notifempty
    compress
    delaycompress
    dateext
    su root agent
    create 0660 root agent
    sharedscripts
    postrotate
        chattr +a /var/log/claude-audit/command-audit.jsonl 2>/dev/null || true
    endscript
    prerotate
        chattr -a /var/log/claude-audit/command-audit.jsonl 2>/dev/null || true
    endscript
}

/var/log/claude-audit/sensitive-ops.log {
    daily
    rotate 30
    missingok
    notifempty
    compress
    delaycompress
    dateext
    su root agent
    create 0660 root agent
    postrotate
        chattr +a /var/log/claude-audit/sensitive-ops.log 2>/dev/null || true
    endscript
    prerotate
        chattr -a /var/log/claude-audit/sensitive-ops.log 2>/dev/null || true
    endscript
}

/var/log/claude-audit/hook-debug.log {
    daily
    rotate 7
    missingok
    notifempty
    compress
    delaycompress
    dateext
    su root agent
    create 0660 root agent
    postrotate
        chattr +a /var/log/claude-audit/hook-debug.log 2>/dev/null || true
    endscript
    prerotate
        chattr -a /var/log/claude-audit/hook-debug.log 2>/dev/null || true
    endscript
}
